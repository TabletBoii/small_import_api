2025-06-13 16:36:46 INFO watchfiles.main 2 changes detected
2025-06-13 16:36:47 INFO watchfiles.main 3 changes detected
2025-06-13 16:36:47 INFO watchfiles.main 5 changes detected
2025-06-13 16:36:48 INFO uvicorn.error Started server process [18152]
2025-06-13 16:36:48 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:36:48 INFO uvicorn.error Application startup complete.
2025-06-13 16:36:48 INFO watchfiles.main 1 change detected
2025-06-13 16:36:50 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 46, in status_refresh_ob_op
    async with cls_factory as instance:
  File "C:\Program Files\Python312\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\callers\import_generic.py", line 24, in _dependency
    formatted_items = [body_model.parse_obj(item) for item in items]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\pydantic\main.py", line 1162, in parse_obj
    return cls.model_validate(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\pydantic\main.py", line 596, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for StatusRefreshObOpModel
  Input should be a valid dictionary or instance of StatusRefreshObOpModel [type=model_type, input_value=1352271, input_type=int]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-06-13 16:36:50 INFO uvicorn.access 127.0.0.1:59704 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:37:03 INFO watchfiles.main 1 change detected
2025-06-13 16:37:04 INFO watchfiles.main 1 change detected
2025-06-13 16:37:25 INFO watchfiles.main 1 change detected
2025-06-13 16:37:40 INFO watchfiles.main 1 change detected
2025-06-13 16:38:40 INFO watchfiles.main 1 change detected
2025-06-13 16:39:09 INFO watchfiles.main 1 change detected
2025-06-13 16:39:17 INFO watchfiles.main 1 change detected
2025-06-13 16:39:23 INFO watchfiles.main 1 change detected
2025-06-13 16:41:39 INFO watchfiles.main 1 change detected
2025-06-13 16:41:55 INFO watchfiles.main 1 change detected
2025-06-13 16:42:11 INFO watchfiles.main 10 changes detected
2025-06-13 16:42:16 INFO uvicorn.error Started server process [9644]
2025-06-13 16:42:16 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:42:16 INFO uvicorn.error Application startup complete.
2025-06-13 16:42:19 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 48, in status_refresh_ob_op
    return await instance.run()
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 35, in run
    claim_statuses = await self.__execute_query(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 28, in __execute_query
    raise e
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 25, in __execute_query
    result = await session.execute(text(query))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")
[SQL: 
            SELECT inc, confirmed_full, status FROM claim WHERE inc IN ();
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-13 16:42:19 INFO uvicorn.access 127.0.0.1:61798 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:42:45 INFO uvicorn.error Shutting down
2025-06-13 16:42:45 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:42:45 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:42:45 INFO uvicorn.error Finished server process [9644]
2025-06-13 16:42:49 INFO uvicorn.error Started server process [8712]
2025-06-13 16:42:49 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:42:49 INFO uvicorn.error Application startup complete.
2025-06-13 16:42:52 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 48, in status_refresh_ob_op
    return await instance.run()
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 36, in run
    claim_statuses = await self.__execute_query(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 28, in __execute_query
    raise e
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 25, in __execute_query
    result = await session.execute(text(query))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")
[SQL: 
            SELECT inc, confirmed_full, status FROM claim WHERE inc IN ();
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-13 16:42:52 INFO uvicorn.access 127.0.0.1:61904 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:42:54 INFO watchfiles.main 3 changes detected
2025-06-13 16:43:05 INFO uvicorn.error Shutting down
2025-06-13 16:43:05 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:43:05 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:43:05 INFO uvicorn.error Finished server process [8712]
2025-06-13 16:43:06 INFO watchfiles.main 2 changes detected
2025-06-13 16:43:07 INFO watchfiles.main 5 changes detected
2025-06-13 16:43:07 INFO uvicorn.error Started server process [156]
2025-06-13 16:43:07 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:43:07 INFO uvicorn.error Application startup complete.
2025-06-13 16:43:07 INFO watchfiles.main 1 change detected
2025-06-13 16:43:07 INFO watchfiles.main 3 changes detected
2025-06-13 16:43:08 INFO uvicorn.error Shutting down
2025-06-13 16:43:09 INFO uvicorn.error Waiting for connections to close. (CTRL+C to force quit)
2025-06-13 16:43:10 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 48, in status_refresh_ob_op
    return await instance.run()
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 35, in run
    query = self.get_formated_query()
                     ^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 28, in __execute_query
    # print(e)
    ^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 25, in __execute_query
    async with self.session_factory() as session:
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")
[SQL: 
            SELECT inc, confirmed_full, status FROM claim WHERE inc IN ();
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-13 16:43:10 INFO uvicorn.access 127.0.0.1:58398 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:43:10 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:43:10 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:43:10 INFO uvicorn.error Finished server process [156]
2025-06-13 16:43:10 INFO watchfiles.main 2 changes detected
2025-06-13 16:43:11 INFO watchfiles.main 1 change detected
2025-06-13 16:43:12 INFO uvicorn.error Started server process [19376]
2025-06-13 16:43:12 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:43:12 INFO uvicorn.error Application startup complete.
2025-06-13 16:43:12 INFO watchfiles.main 6 changes detected
2025-06-13 16:43:33 INFO uvicorn.error Started server process [18192]
2025-06-13 16:43:33 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:43:33 INFO uvicorn.error Application startup complete.
2025-06-13 16:43:36 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 48, in status_refresh_ob_op
    return await instance.run()
           ^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 36, in run
    claim_statuses = await self.__execute_query(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 29, in __execute_query
    raise e
  File "E:\python\kompas_importer_backend\controllers\office\claims_status_refresh.py", line 26, in __execute_query
    result = await session.execute(text(query))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 461, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 71, in execute
    return self.await_(self._execute_async(operation, parameters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\sqlalchemy\connectors\asyncio.py", line 80, in _execute_async
    result = await self._cursor.execute(operation, parameters or ())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 132, in execute
    await self._run_operation(self._impl.execute, sql, *params)
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\aioodbc\cursor.py", line 30, in _run_operation
    result = await self._conn._execute(func, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python312\Lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.ProgrammingError: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Incorrect syntax near ')'. (102) (SQLExecDirectW)")
[SQL: 
            SELECT inc, confirmed_full, status FROM claim WHERE inc IN ();
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-13 16:43:36 INFO uvicorn.access 127.0.0.1:58433 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:43:53 INFO watchfiles.main 3 changes detected
2025-06-13 16:44:12 INFO uvicorn.error Shutting down
2025-06-13 16:44:12 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:44:12 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:44:12 INFO uvicorn.error Finished server process [18192]
2025-06-13 16:44:13 INFO watchfiles.main 2 changes detected
2025-06-13 16:44:13 INFO watchfiles.main 5 changes detected
2025-06-13 16:44:14 INFO uvicorn.error Started server process [14616]
2025-06-13 16:44:14 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:44:14 INFO uvicorn.error Application startup complete.
2025-06-13 16:44:14 INFO watchfiles.main 1 change detected
2025-06-13 16:44:15 INFO watchfiles.main 3 changes detected
2025-06-13 16:44:16 ERROR root An unexpected error occurred.
Traceback (most recent call last):
  File "E:\python\kompas_importer_backend\decorators\response.py", line 19, in wrapper
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\routers\api_router\api\office.py", line 46, in status_refresh_ob_op
    async with cls_factory as instance:
  File "C:\Program Files\Python312\Lib\contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\callers\import_generic.py", line 24, in _dependency
    formatted_items = [body_model.parse_obj(item) for item in items]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\pydantic\main.py", line 1162, in parse_obj
    return cls.model_validate(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\python\kompas_importer_backend\venv\Lib\site-packages\pydantic\main.py", line 596, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for StatusRefreshObOpModel
  Input should be a valid dictionary or instance of StatusRefreshObOpModel [type=model_type, input_value=1352271, input_type=int]
    For further information visit https://errors.pydantic.dev/2.9/v/model_type
2025-06-13 16:44:16 INFO uvicorn.access 127.0.0.1:58522 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:44:16 INFO uvicorn.error Shutting down
2025-06-13 16:44:16 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:44:16 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:44:16 INFO uvicorn.error Finished server process [14616]
2025-06-13 16:44:17 INFO watchfiles.main 2 changes detected
2025-06-13 16:44:17 INFO watchfiles.main 5 changes detected
2025-06-13 16:44:18 INFO uvicorn.error Started server process [4536]
2025-06-13 16:44:18 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:44:18 INFO uvicorn.error Application startup complete.
2025-06-13 16:44:18 INFO watchfiles.main 1 change detected
2025-06-13 16:44:22 INFO watchfiles.main 1 change detected
2025-06-13 16:44:36 INFO watchfiles.main 1 change detected
2025-06-13 16:44:45 INFO uvicorn.error Started server process [11552]
2025-06-13 16:44:45 INFO uvicorn.error Waiting for application startup.
2025-06-13 16:44:45 INFO uvicorn.error Application startup complete.
2025-06-13 16:44:48 INFO uvicorn.access 127.0.0.1:58590 - "POST /api/status_refresh_ob_op HTTP/1.1" 200
2025-06-13 16:45:02 INFO watchfiles.main 3 changes detected
2025-06-13 16:45:06 INFO uvicorn.error Shutting down
2025-06-13 16:45:06 INFO uvicorn.error Waiting for application shutdown.
2025-06-13 16:45:06 INFO uvicorn.error Application shutdown complete.
2025-06-13 16:45:06 INFO uvicorn.error Finished server process [11552]
